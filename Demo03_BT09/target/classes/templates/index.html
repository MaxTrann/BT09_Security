<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security6">

<head>
  <meta charset="UTF-8">
  <title>Product Manager</title>

  <!-- Bootstrap 5 -->
  <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css}" rel="stylesheet">

  <style>
    body { background:#f7f8fb; }
    .container-narrow { max-width: 1100px; }
    .topbar {
      background:#ffffff; border:1px solid #e9eef5; border-radius:14px;
      padding:16px 18px; margin:18px auto; box-shadow:0 2px 12px rgba(18,38,63,.04);
    }
    .welcome b { font-weight:700; }
    .roles i { color:#6c757d; }
    .logout-btn { border-width:2px; }
    .section-title { margin: 14px 0 6px; }
    .cta-create a { border-width:2px; }

    /* Bảng sản phẩm “e-commerce look” */
    .table-card {
      background:#fff; border:1px solid #e9eef5; border-radius:14px; overflow:hidden;
      box-shadow:0 8px 24px rgba(18,38,63,.06);
    }
    table.product-table thead th {
      background:#f3f6fb; color:#556070; font-weight:700; text-transform:uppercase;
      font-size:.78rem; letter-spacing:.04em; border-bottom:1px solid #e6ecf5;
    }
    table.product-table tbody tr { transition: background .15s ease; }
    table.product-table tbody tr:hover { background:#fafcff; }
    .price { font-weight:700; color:#0d6efd; }
    .actions a { margin-right:.35rem; }
    .badge-role { background:#eef2ff; color:#3b5bdb; border:1px solid #dfe6ff; }

    /* Mobile */
    @media (max-width: 576px) {
      .d-flex.responsive { flex-direction: column; gap: 10px; align-items: flex-start; }
      .table-responsive { border:0; }
    }
  </style>
</head>

<body>
<div class="container container-narrow">

  <!-- TOP BAR (giữ nguyên nội dung/thuộc tính) -->
  <div class="topbar d-flex justify-content-between align-items-center responsive">
    <div class="welcome" sec:authorize="isAuthenticated()">
      Welcome <b><span sec:authentication="name">Username</span></b>
      &nbsp;
      <i class="roles">
        <span sec:authentication="principal.authorities">Roles</span>
      </i>
    </div>

    <form th:action="@{/logout}" method="post" class="m-0">
      <input type="submit" value="Logout" class="btn btn-outline-secondary btn-sm logout-btn"/>
    </form>
  </div>

  <!-- TIÊU ĐỀ + NÚT CREATE (giữ nguyên logic) -->
  <div class="d-flex justify-content-between align-items-center section-title">
    <h1 class="h4 m-0">Product Manager</h1>
    <div class="cta-create" sec:authorize="hasAnyAuthority('CREATOR', 'ADMIN')">
      <a href="new" class="btn btn-success btn-sm">+ Create New Product</a>
    </div>
  </div>

  <!-- BẢNG SẢN PHẨM (giữ nguyên cấu trúc/thymeleaf của bạn) -->
  <div class="table-card mt-3">
    <div class="table-responsive">
      <table border="1" cellpadding="10"
             class="table table-hover align-middle product-table m-0">
        <thead>
        <tr>
          <th>Product ID</th>
          <th>Name</th>
          <th>Brand</th>
          <th>Made In</th>
          <th>Price</th>
          <th sec:authorize="hasAnyAuthority('ADMIN', 'EDITOR')">Actions</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="product : ${listProducts}">
          <td th:text="${product.id}">Product ID</td>
          <td th:text="${product.name}">Name</td>
          <td th:text="${product.brand}">Brand</td>
          <td th:text="${product.madein}">Made in</td>
          <td class="price"
              th:text="${#numbers.formatDecimal(product.price, 0, 'POINT', 0, 'POINT')} + ' ₫'">0 ₫</td>

          <td class="actions" sec:authorize="hasAnyAuthority('ADMIN', 'EDITOR')">
            <a th:href="@{'/edit/' + ${product.id}}"
               class="btn btn-outline-primary btn-sm">Edit</a>
            <a sec:authorize="hasAuthority('ADMIN')"
               th:href="@{'/delete/' + ${product.id}}"
               class="btn btn-outline-danger btn-sm"
               onclick="return confirm('Delete this product?');">Delete</a>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js}"></script>
</body>
</html>
